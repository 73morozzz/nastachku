%h1=t('.events20')
%h5=t('.user_lectures_title')
%br

.row.workshop
  .span3
    %ul.nav.nav-list.b-affix
      - workshops.each do |workshop|
        = item :li, workshop, user_lectures_path(s: params[:s], workshop_id_eq: workshop.id)

  .span9
    - if @lectures.empty?
      = t(".not_added_yet")
      = link_to t(".first_speaker"), new_account_lecture_path
    - else
      .span12
        #{ t '.sort_by' }:&nbsp;
        -#FIXME решение в лоб. Наверняка есть более элегантное решение
        = sort_clink(@search, :lecture_votings_count, t('.by_lecture_votings_count'), { workshop_id_eq: params[:workshop_id_eq] })
        &nbsp;&nbsp;
        = sort_clink(@search, :created_at, t('.by_created_at'), { workshop_id_eq: params[:workshop_id_eq] })
        %br
        %br
        .clearfix
      .row

      - @lectures.each do |lecture|
        .row-fluid.event-item
          .span4.sinfo
            .col-l
              %h5= lecture.user.full_name
              %h6
                %strong= lecture.user.company
              .pic
                - if lecture.user.photo.url
                  = image_tag(lecture.user.photo.url)
              .buttons-group{ data: { success: t('.already_voted') } }
                -if signed_in?
                  - if lecture.lecture_votings.voted_by?(current_user)
                    .btn.btn-no-clickable= t('.already_voted')
                  - else
                    = link_to t('.vote_this_lecture'), api_lecture_lecture_votings_path(lecture), remote: true, method: :post, class: 'vote-event btn btn-shine'
                -else
                  .btn.btn-no-clickable= t('.they_voted')
                %span.btn.votings-count.btn-no-clickable
                  = lecture.lecture_votings.size
          .span8
            %h4= lecture.title
            %P.ainfo= nl2br lecture.thesises
          .clearfix
